# 플랫폼 수집 가능성 및 수용성 평가 설계서

목표: 프로젝트 초기에 어떤 플랫폼을 먼저 붙일지 데이터 기반으로 결정한다.
이 문서는 **“설계 완성도”보다 “실질적으로 수집 가능한지”**를 우선 판별한다.

---

## 1) 실무 판단 원칙

- 설계는 후보 플랫폼 1차 선별 후 최적화한다.
- 수집 부하(`DB`, `이미지`)와 정확도(`필드 완성도`, `검증 실패`)를 동시에 본다.
- 수집 불가 플로우는 `STEALTH_AUTOMATION` 혹은 `BLOCKED`로 내려가도 전체 프로젝트는 유지되어야 한다.

---

## 2) 수집성 평가 항목

- 접근성
  - API/공개 API 가능성
  - UI 자동화 동작 가능성(사용자 동반)
  - 차단 가능성(403/429/캡차/토큰 요구)

- 데이터 완성도
  - 필수 항목 추출률: 주소, 가격, 면적, 입주일, 층수, 매물유형, 이미지
  - 파싱 실패율

- 비용성
  - 매물당 raw + 정규화 저장량(예상)
  - 매물당 이미지 수(평균)
  - 대표 이미지 + 썸네일 저장 정책 적용 후 이미지 비용

- 정합성 리스크
  - 전용/공용 면적 혼재 비율
  - 가격단위/표기 혼재
  - 주소 정규화 오차

- 운영 리스크
  - 실패 반복 시 모드 강등(자동/사용자 동반/수동)
  - 사용자 허용도(브라우저 동반 동의 범위)

## 2-1) 1차 수집 실행 체크(2026-02-16 기준 최신 집계, query_probe_20260216)

- 직방: PASS (8/8)
- 네이버 부동산: PASS (8/8) · 수집 모드 `BLOCKED`에서 캡처 경로로 정규화 성공
- 다방: **PASS** · Playwright stealth + page.route() 필터 인젝션으로 전환 완료
- 피터팬: **PASS** (4구 테스트 성공) · Playwright stealth + route 필터 인젝션 + API 응답 인터셉트 방식으로 전환 완료 (2026-02-16)
- 당근 부동산: **PASS** (7/8개 구 성공, 67건) · Direct fetch + JSON-LD 파싱, 면적 미제공
- 부동산114: **PASS** (매물 적음) · Playwright stealth + page.evaluate(fetch), 노원구 2건/성동구 1건 수집 확인
- KB부동산: **진행 중** · CDP 기반 수집기 구현 완료, 수집 가능성 검증 중
- 네모: 제외 확정 (상업용 부동산 전문)
- 호갱노노: 제외 확정 (아파트 전문)

---

## 3) 수치화 공식(본 프로젝트에서 사용)

- 일일 예상 매물수
  - `일일조회매물 = 쿼리수 x 페이지수/쿼리 x 매물/페이지 x 추출성공률`

- 일일 DB 증가량(GB)
  - `매일DB = 일일조회매물 x (raw_kb + normalized_kb) / 1,024 / 1,024`

- 일일 이미지 증가량(GB)
  - `매일이미지 = 일일조회매물 x 저장이미지수 x 이미지_kb / 1,024 / 1,024`

- 총점(0~100)
  - 접근성 25%, 완성도 25%, 안정성 20%, 비용 20%, 정합성 10%
  - `총점 = 가중합`

- 단계 분류
  - A: 전체 실행 우선순위 (총점 >= 82, 비용/리스크 양호)
  - B: 조건부 실행 (62~81)
- C: STEALTH_AUTOMATION or 보류 (<=61)

---

## 4) 실행 산출물

`/Users/hyunsoo/personal-projects/my-rent-finder/docs/platform_feasibility_report.md`

- 플랫폼별 점수/등급
- 일일/월간 스토리지 추정치
- `A/B/C` 추천군
- 오탐 방지 우선순위(면적·가격·주소)

---

## 5) 이번 초기 실험 기준값(예시)

- 대상 조건: 서울시, 시/구/동 기반 검색, 월세 최대, 최소 평수 기반
- 일일 쿼리 120~180개
- 이미지 저장 상한: 일일 1.0GB, 총 저장 상한 3개월 기준
- 매물 자동 저장 상한: 일일 3,000건

---

## 6) 실행 체크리스트

1. 플랫폼별 1차 샘플링(200~500건)로 접근성/성공률 측정
2. 위 공식으로 점수 계산
3. A/B/C 분류 후 다음 순서로 붙이기
   - A: 코드 우선 구현
   - B: 조건부/리스크 보완
 - C: STEALTH_AUTOMATION 경로 또는 배제
4. 매주 재계산(차단 정책 변동 반영)
